import * as semver from "./semver.js";
/// allows inputs `nodejs.org@16` when `semver.parse` would reject
export function parse(input) {
    const match = input.match(/^(.+?)([\^=~<>@].+)?$/);
    if (!match)
        throw new Error(`invalid pkgspec: ${input}`);
    if (!match[2])
        match[2] = "*";
    const project = match[1];
    if (match[2] == "@latest") {
        return { project, constraint: new semver.Range('*') };
    }
    else {
        const constraint = new semver.Range(match[2]);
        return { project, constraint };
    }
}
export function compare(a, b) {
    return a.project === b.project
        ? a.version.compare(b.version)
        : a.project.localeCompare(b.project);
}
export function str(pkg) {
    if (!("constraint" in pkg)) {
        return `${pkg.project}=${pkg.version}`;
    }
    else if (pkg.constraint.set === "*") {
        return pkg.project;
    }
    else {
        return `${pkg.project}${pkg.constraint}`;
    }
}
